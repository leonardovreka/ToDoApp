# ToDoApp API

A Django REST Framework backend for managing to-do items with JWT authentication, user registration, filtering/search/order support, and autogenerated API docs.

## Features

- User registration endpoint that returns JWT access/refresh tokens.
- JWT auth via `djangorestframework-simplejwt`.
- CRUD operations for todos.
- Multi-tenant behavior:
  - Regular users can only see/manage their own todos.
  - Staff users can access all todos.
- Filtering, searching, and ordering on todo lists.
- OpenAPI schema + Swagger/ReDoc documentation via `drf-spectacular`.

## Tech Stack

- Python + Django
- Django REST Framework
- SimpleJWT
- django-filter
- drf-spectacular
- SQLite (default)

## Project Structure

```text
config/               # Django project settings and URL configuration
todolist/             # Main app (models, serializers, views, tests)
manage.py
requirements.txt
```

## Getting Started

### 1) Clone and enter the project

```bash
git clone <your-repo-url>
cd ToDoApp
```

### 2) Create and activate a virtual environment

```bash
python -m venv .venv
source .venv/bin/activate          # Linux/macOS
# .venv\\Scripts\\activate         # Windows PowerShell
```

### 3) Install dependencies

```bash
pip install -r requirements.txt
```

### 4) Apply migrations

```bash
python manage.py migrate
```

### 5) Run the server

```bash
python manage.py runserver
```

API base URL (default): `http://127.0.0.1:8000/`

## Authentication Flow

1. Register a new user:
   - `POST /api/auth/register/`
2. Login and obtain JWT tokens:
   - `POST /api/auth/token/`
3. Use access token in requests:
   - `Authorization: Bearer <access_token>`
4. Refresh token when needed:
   - `POST /api/auth/token/refresh/`

## API Endpoints

### Auth

- `POST /api/auth/register/` — Create user and return tokens
- `POST /api/auth/token/` — Obtain access/refresh token pair
- `POST /api/auth/token/refresh/` — Refresh access token
- `POST /api/auth/token/verify/` — Verify token validity

### Todos

- `GET /api/todos/` — List todos
- `POST /api/todos/` — Create todo
- `GET /api/todos/{id}/` — Retrieve todo
- `PATCH /api/todos/{id}/` — Partial update
- `PUT /api/todos/{id}/` — Full update
- `DELETE /api/todos/{id}/` — Delete todo

### API Docs

- `GET /api/schema/` — OpenAPI schema
- `GET /api/docs/` — Swagger UI
- `GET /api/redoc/` — ReDoc

## Todo Fields

- `id` (read-only)
- `owner_username` (read-only)
- `title`
- `description`
- `is_completed`
- `due_date`
- `created_at` (read-only)
- `updated_at` (read-only)

## Querying Todos

The todo list endpoint supports:

- **Filtering** via query params:
  - `is_completed`
  - `due_date`
- **Search** on:
  - `title`
  - `description`
- **Ordering** by:
  - `created_at`
  - `due_date`
  - `title`

Examples:

```http
GET /api/todos/?is_completed=false
GET /api/todos/?search=meeting
GET /api/todos/?ordering=due_date
GET /api/todos/?ordering=-created_at
```

## Environment Variables

- `SECRET_KEY` (default: `unsafe-dev-key`)
- `DEBUG` (default: `True`)

For production, set a secure `SECRET_KEY`, disable `DEBUG`, and configure `ALLOWED_HOSTS`.

## Running Tests

```bash
python manage.py test
```

## Notes

- Default database is SQLite (`db.sqlite3`).
- Global DRF permission is `IsAuthenticated`, so unauthenticated requests will be denied except for explicitly open endpoints (like registration and token endpoints).
